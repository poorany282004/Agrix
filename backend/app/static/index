<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Agrix — Rice Disease Detector</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">Agrix</div>
      <div class="tagline">AI • IoT • Rice Health</div>
    </div>
    <div class="actions">
      <button id="scanBtn" class="btn primary">Quick Scan</button>
    </div>
  </header>

  <main class="main">
    <section class="left">
      <div class="card camera">
        <div class="card-header">
          <h2>Capture / Upload</h2>
          <p class="hint">Take a close-up photo of a rice leaf. Good lighting and a steady hand help.</p>
        </div>

        <div class="capture-area" id="captureArea">
          <video id="video" autoplay playsinline></video>
          <img id="previewImg" alt="preview" />
          <canvas id="canvas" style="display:none"></canvas>
        </div>

        <div class="controls">
          <input id="fileInput" type="file" accept="image/*" capture="environment" style="display:none" />
          <button id="btnCapture" class="btn">Take Photo</button>
          <button id="btnChoose" class="btn">Choose File</button>
          <button id="btnClear" class="btn ghost">Clear</button>
        </div>
      </div>

      <div class="card sensors">
        <h3>Sensor / Context (optional)</h3>
        <form id="sensorForm" autocomplete="off">
          <div class="grid">
            <label>RH (last 24h %)
              <input id="rh24" name="rh24" type="number" step="0.1" placeholder="e.g., 85" />
            </label>
            <label>Temp (48h °C)
              <input id="temp48" name="temp48" type="number" step="0.1" placeholder="e.g., 22" />
            </label>
            <label>Soil moisture %
              <input id="soil_moisture" name="soil_moisture" type="number" step="0.1" placeholder="e.g., 38" />
            </label>
            <label>Recent rain
              <select id="recent_rain" name="recent_rain">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </label>
          </div>
        </form>
      </div>

      <div class="card actions">
        <button id="submitBtn" class="btn primary large">Submit for Diagnosis</button>
        <div id="status" class="status">Ready</div>
      </div>
    </section>

    <aside class="right">
      <div class="card result" id="resultCard" aria-live="polite">
        <h3>Result</h3>
        <div class="result-row"><strong>Disease:</strong> <span id="diseaseLabel">—</span></div>
        <div class="result-row"><strong>Confidence:</strong> <span id="diseaseConf">—</span></div>
        <div class="result-row"><strong>Severity:</strong> <span id="diseaseSeverity">—</span></div>
        <div class="result-row"><strong>Advisory:</strong>
          <div id="advisoryText" class="advisory">—</div>
        </div>
        <div id="saliencyWrap" class="saliency" style="display:none">
          <h4>Saliency (Grad-CAM)</h4>
          <img id="saliencyImg" alt="saliency overlay" />
        </div>

        <div class="feedback">
          <label>Correction:
            <select id="correction">
              <option value="">-- choose --</option>
              <option value="healthy">healthy</option>
              <option value="blast">blast</option>
              <option value="brown_spot">brown_spot</option>
              <option value="bacterial_blight">bacterial_blight</option>
              <option value="other">other</option>
            </select>
          </label>
          <button id="sendFeedback" class="btn">Send Feedback</button>
        </div>
      </div>

      <div class="card tips">
        <h4>Tips</h4>
        <ul>
          <li>Use natural light; avoid shadows on the leaf.</li>
          <li>Hold the camera steady and focus on the lesion.</li>
          <li>Capture multiple angles if possible.</li>
        </ul>
      </div>
    </aside>
  </main>

  <footer class="footer">
    <div>Agrix — Prototype. Backend endpoints: <code>/api/v1/upload</code>, <code>/api/v1/result/{job_id}</code>, <code>/api/v1/feedback/{job_id}</code></div>
  </footer>

  <script src="app.js"></script>
</body>
</html>
